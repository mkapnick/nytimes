13:37:43 SQL> @/dbbackups/ECPR/migrations/core_owner/22.2-create-offers-SAR-247/upgrade.sql
13:37:43 SQL> 
13:37:43 SQL> WHENEVER SQLERROR EXIT SQL.SQLCODE ROLLBACK
13:37:43 SQL> SET SCAN OFF
13:37:43 SQL> SET DEFINE OFF
13:37:43 SQL> 
13:37:43 SQL> 
13:37:43 SQL> DECLARE
13:37:43   2  	TMP_VAR NUMBER;
13:37:43   3  	CUR_PRD_ID NUMBER;
13:37:43   4  	CUR_CAPABILITY_ID NUMBER;
13:37:43   5  BEGIN
13:37:43   6  	BEGIN
13:37:43   7  	  SELECT 1 INTO TMP_VAR FROM OFFER_CHAIN WHERE ID = 1188880 AND ROWNUM <= 1;
13:37:43   8  	  UPDATE OFFER_CHAIN SET NAME='NYTimes: Web + Smartphone App', DESCRIPTION='Unlimited access to NYTimes.com and the NYTimes smartphone app.*', PRODUCT_URI='', VENDOR_SOURCE_ID='1', BILLING_SOURCE_ID=(SELECT ID FROM BILLING_SOURCE BS WHERE BS.NAME='DD-LivingSocial'), IS_SEAT_LICENSE=0, GROUP_ACCOUNT_TYPE_ID='NO',IS_ADDRESS_REQUIRED=1, OFFER_CHAIN_STATUS_ID = 1, UPDATE_DATE = SYSDATE, UPDATED_BY = 'OFFERMAKER', IS_GIFT_CERTIFICATE='1', REVOKE_ENTITLEMENTS = '0', ADOPTABILITY_WINDOW_START_DATE = to_date('02-Oct-2012 00:00:00','DD-MON-YY HH24:MI:SS'), ADOPTABILITY_WINDOW_END_DATE = to_date('24-Oct-2020 00:00:00','DD-MON-YY HH24:MI:SS') WHERE ID = 1188880;
13:37:43   9  	EXCEPTION
13:37:43  10  	  WHEN NO_DATA_FOUND THEN
13:37:43  11  	    INSERT INTO OFFER_CHAIN (ID, NAME, DESCRIPTION, ADOPTABILITY_WINDOW_START_DATE, ADOPTABILITY_WINDOW_END_DATE, IS_GIFT_CERTIFICATE, PRODUCT_URI, OFFER_CHAIN_STATUS_ID, REVOKE_ENTITLEMENTS, VENDOR_SOURCE_ID, BILLING_SOURCE_ID, IS_SEAT_LICENSE, GROUP_ACCOUNT_TYPE_ID, IS_ADDRESS_REQUIRED, CREATED_BY, CREATE_DATE, updated_by, update_date) VALUES (1188880, 'NYTimes: Web + Smartphone App', 'Unlimited access to NYTimes.com and the NYTimes smartphone app.*', to_date('02-Oct-2012 00:00:00','DD-MON-YY HH24:MI:SS'), to_date('24-Oct-2020 00:00:00','DD-MON-YY HH24:MI:SS'), '1', NULL, '1', '0', '1', (SELECT ID FROM BILLING_SOURCE BS WHERE BS.NAME='DD-LivingSocial'), decode('NO','IL',1,0), 'NO', '1', 'OFFERMAKER', SYSDATE, 'OFFERMAKER', SYSDATE);
13:37:43  12  	END;
13:37:43  13  	DELETE FROM OFFER_CHAIN_ELIGIBILITY WHERE offer_chain_id = 1188880;
13:37:43  14  	INSERT INTO OFFER_CHAIN_ELIGIBILITY (ID, OFFER_CHAIN_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (ELG_ID_SEQ.NEXTVAL, 1188880, 'IS_COMP', '1', 'OFFERMAKER', SYSDATE);
13:37:43  15  	DELETE FROM OFFER_CHAIN_META_DATA WHERE offer_chain_id = 1188880;
13:37:43  16  	INSERT INTO OFFER_CHAIN_META_DATA (ID, OFFER_CHAIN_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (OCMD_ID_SEQ.NEXTVAL, 1188880, 'BUNDLE_EXPLANATION', 'Bundle A - Living Social 8 Week Sub - Purchase OC', 'OFFERMAKER', SYSDATE);
13:37:43  17  	INSERT INTO OFFER_CHAIN_META_DATA (ID, OFFER_CHAIN_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (OCMD_ID_SEQ.NEXTVAL, 1188880, 'PRICE_DESCRIPTION', '8 Week Living Social Promotion Subscription for $1 - Paid to Living Social - Purchase', 'OFFERMAKER', SYSDATE);
13:37:43  18  	INSERT INTO OFFER_CHAIN_META_DATA (ID, OFFER_CHAIN_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (OCMD_ID_SEQ.NEXTVAL, 1188880, 'PRICE_SHORT_DESCRIPTION', 'BNDL A / $0 8 wks Living Social GC purch', 'OFFERMAKER', SYSDATE);
13:37:43  19  	INSERT INTO OFFER_CHAIN_META_DATA (ID, OFFER_CHAIN_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (OCMD_ID_SEQ.NEXTVAL, 1188880, 'OFFER_TYPE', 'Living Social Subscription for 8 weeks', 'OFFERMAKER', SYSDATE);
13:37:43  20  	INSERT INTO OFFER_CHAIN_META_DATA (ID, OFFER_CHAIN_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (OCMD_ID_SEQ.NEXTVAL, 1188880, 'OFFER_PRICE', '$1 for 8 weeks', 'OFFERMAKER', SYSDATE);
13:37:43  21  	INSERT INTO OFFER_CHAIN_META_DATA (ID, OFFER_CHAIN_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (OCMD_ID_SEQ.NEXTVAL, 1188880, 'PROMO_PRICE_FOOTER_LABEL', '8 Weeks', 'OFFERMAKER', SYSDATE);
13:37:43  22  	INSERT INTO OFFER_CHAIN_META_DATA (ID, OFFER_CHAIN_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (OCMD_ID_SEQ.NEXTVAL, 1188880, 'BILLING_CYCLE', '8 week subscription', 'OFFERMAKER', SYSDATE);
13:37:43  23  	INSERT INTO OFFER_CHAIN_META_DATA (ID, OFFER_CHAIN_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (OCMD_ID_SEQ.NEXTVAL, 1188880, 'SUBSCRIBER_TYPE', 'Daily Deals', 'OFFERMAKER', SYSDATE);
13:37:43  24  	INSERT INTO OFFER_CHAIN_META_DATA (ID, OFFER_CHAIN_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (OCMD_ID_SEQ.NEXTVAL, 1188880, 'redemption offer chain id', '1188881, 1188882', 'OFFERMAKER', SYSDATE);
13:37:43  25  	INSERT INTO OFFER_CHAIN_META_DATA (ID, OFFER_CHAIN_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (OCMD_ID_SEQ.NEXTVAL, 1188880, 'BUNDLE', 'Bundle A (Web+SP)', 'OFFERMAKER', SYSDATE);
13:37:43  26  	INSERT INTO OFFER_CHAIN_META_DATA (ID, OFFER_CHAIN_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (OCMD_ID_SEQ.NEXTVAL, 1188880, 'ADX_BUNDLE', 'MM_PROMO', 'OFFERMAKER', SYSDATE);
13:37:43  27  	INSERT INTO OFFER_CHAIN_META_DATA (ID, OFFER_CHAIN_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (OCMD_ID_SEQ.NEXTVAL, 1188880, 'SIEBEL_CAMPAIGN_CODE', '3H8W6 ', 'OFFERMAKER', SYSDATE);
13:37:43  28  	INSERT INTO OFFER_CHAIN_META_DATA (ID, OFFER_CHAIN_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (OCMD_ID_SEQ.NEXTVAL, 1188880, 'IS_COMP', '1', 'OFFERMAKER', SYSDATE);
13:37:43  29  	INSERT INTO OFFER_CHAIN_META_DATA (ID, OFFER_CHAIN_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (OCMD_ID_SEQ.NEXTVAL, 1188880, 'ANNUAL_PRICE', '195.00', 'OFFERMAKER', SYSDATE);
13:37:43  30  	INSERT INTO OFFER_CHAIN_META_DATA (ID, OFFER_CHAIN_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (OCMD_ID_SEQ.NEXTVAL, 1188880, 'UID', '548660ec8d044948417f58d00123daf91c2c6f70299dc11de2a4f5817a609ffa', 'OFFERMAKER', SYSDATE);
13:37:43  31  	DELETE FROM OFFER_CHAIN_NOTIFICATION_TYPE WHERE offer_chain_id = 1188880;
13:37:43  32  	BEGIN
13:37:43  33  	  SELECT 1 INTO TMP_VAR FROM OFFER_OFFER_CHAIN WHERE OFFER_CHAIN_ID = 1188880 AND INDEX_VALUE = 0 AND ROWNUM <= 1;
13:37:43  34  	EXCEPTION
13:37:43  35  	  WHEN NO_DATA_FOUND THEN
13:37:43  36  	INSERT INTO OFFER (ID, OFFER_STATUS_ID, ENTITLEMENT_DURATION, CREATED_BY, CREATE_DATE, updated_by, update_date) VALUES (OFR_ID_SEQ.NEXTVAL, 1, 'P0Y0M56DT0H0M', 'OFFERMAKER', SYSDATE, 'OFFERMAKER', SYSDATE);
13:37:43  37  	BEGIN
13:37:43  38  	  SELECT ID INTO CUR_PRD_ID FROM PRODUCT WHERE NAME = 'Web' AND PRODUCT_STATUS_ID = 1 AND ROWNUM <= 1;
13:37:43  39  	EXCEPTION
13:37:43  40  	  WHEN NO_DATA_FOUND THEN
13:37:43  41  	    INSERT INTO PRODUCT (ID, NAME, PRODUCTION_COST, PRODUCT_STATUS_ID, PRODUCT_URI, UNIT_PRICE, CREATED_BY, CREATE_DATE) VALUES (PRD_ID_SEQ.NEXTVAL, 'Web', '0', 1, NULL, '0', 'OFFERMAKER', SYSDATE);
13:37:43  42  	    SELECT ID INTO CUR_PRD_ID FROM PRODUCT WHERE NAME = 'Web' AND PRODUCT_STATUS_ID = 1 AND ROWNUM <= 1;
13:37:43  43  	  WHEN OTHERS THEN
13:37:43  44  	    RAISE;
13:37:43  45  	END;
13:37:43  46  	SELECT ID INTO CUR_CAPABILITY_ID FROM CAPABILITY WHERE CODE IN LTRIM(RTRIM((UPPER('MM')))) AND ROWNUM <= 1;
13:37:43  47  	INSERT INTO PRODUCT_OFFERING (ID, PRODUCT_ID, TAX_POLICY_TYPE_ID, QUANTITY, UNIT_PRICE, TAX_CATEGORY_ID, CAPABILITY_ID, CREATED_BY, CREATE_DATE) VALUES (PO_ID_SEQ.NEXTVAL, CUR_PRD_ID, '1', '56', '0', '2', CUR_CAPABILITY_ID, 'OFFERMAKER', SYSDATE);
13:37:43  48  	INSERT INTO PRODUCT_OFFERING_META_DATA (ID, PRODUCT_OFFERING_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (PROMD_ID_SEQ.NEXTVAL, PO_ID_SEQ.CURRVAL, 'entitlement_uri', 'http://:hostname:/svc/user/entitlements/mm/:id:.json', 'OFFERMAKER', SYSDATE);
13:37:43  49  	INSERT INTO PRODUCT_OFFERING_META_DATA (ID, PRODUCT_OFFERING_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (PROMD_ID_SEQ.NEXTVAL, PO_ID_SEQ.CURRVAL, 'DEFAULT_VAT_RATE', '{"*": 0.0}', 'OFFERMAKER', SYSDATE);
13:37:43  50  	INSERT INTO PRODUCT_OFFERING_META_DATA (ID, PRODUCT_OFFERING_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (PROMD_ID_SEQ.NEXTVAL, PO_ID_SEQ.CURRVAL, 'capability', 'MM', 'OFFERMAKER', SYSDATE);
13:37:43  51  	INSERT INTO OFFER_PRODUCT_OFFERING (OFFER_ID, PRODUCT_OFFERING_ID, CREATED_BY, CREATE_DATE) VALUES (OFR_ID_SEQ.CURRVAL, PO_ID_SEQ.CURRVAL, 'OFFERMAKER', SYSDATE);
13:37:43  52  	BEGIN
13:37:43  53  	  SELECT ID INTO CUR_PRD_ID FROM PRODUCT WHERE NAME = 'Mobile' AND PRODUCT_STATUS_ID = 1 AND ROWNUM <= 1;
13:37:43  54  	EXCEPTION
13:37:43  55  	  WHEN NO_DATA_FOUND THEN
13:37:43  56  	    INSERT INTO PRODUCT (ID, NAME, PRODUCTION_COST, PRODUCT_STATUS_ID, PRODUCT_URI, UNIT_PRICE, CREATED_BY, CREATE_DATE) VALUES (PRD_ID_SEQ.NEXTVAL, 'Mobile', '0', 1, NULL, '0', 'OFFERMAKER', SYSDATE);
13:37:43  57  	    SELECT ID INTO CUR_PRD_ID FROM PRODUCT WHERE NAME = 'Mobile' AND PRODUCT_STATUS_ID = 1 AND ROWNUM <= 1;
13:37:43  58  	  WHEN OTHERS THEN
13:37:43  59  	    RAISE;
13:37:43  60  	END;
13:37:43  61  	SELECT ID INTO CUR_CAPABILITY_ID FROM CAPABILITY WHERE CODE IN LTRIM(RTRIM((UPPER('MOW')))) AND ROWNUM <= 1;
13:37:43  62  	INSERT INTO PRODUCT_OFFERING (ID, PRODUCT_ID, TAX_POLICY_TYPE_ID, QUANTITY, UNIT_PRICE, TAX_CATEGORY_ID, CAPABILITY_ID, CREATED_BY, CREATE_DATE) VALUES (PO_ID_SEQ.NEXTVAL, CUR_PRD_ID, '1', '56', '0', '2', CUR_CAPABILITY_ID, 'OFFERMAKER', SYSDATE);
13:37:43  63  	INSERT INTO PRODUCT_OFFERING_META_DATA (ID, PRODUCT_OFFERING_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (PROMD_ID_SEQ.NEXTVAL, PO_ID_SEQ.CURRVAL, 'entitlement_uri', 'http://:hostname:/svc/user/entitlements/mow/:id:.json', 'OFFERMAKER', SYSDATE);
13:37:43  64  	INSERT INTO PRODUCT_OFFERING_META_DATA (ID, PRODUCT_OFFERING_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (PROMD_ID_SEQ.NEXTVAL, PO_ID_SEQ.CURRVAL, 'DEFAULT_VAT_RATE', '{"*": 0.0}', 'OFFERMAKER', SYSDATE);
13:37:43  65  	INSERT INTO PRODUCT_OFFERING_META_DATA (ID, PRODUCT_OFFERING_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (PROMD_ID_SEQ.NEXTVAL, PO_ID_SEQ.CURRVAL, 'capability', 'MOW', 'OFFERMAKER', SYSDATE);
13:37:43  66  	INSERT INTO OFFER_PRODUCT_OFFERING (OFFER_ID, PRODUCT_OFFERING_ID, CREATED_BY, CREATE_DATE) VALUES (OFR_ID_SEQ.CURRVAL, PO_ID_SEQ.CURRVAL, 'OFFERMAKER', SYSDATE);
13:37:43  67  	BEGIN
13:37:43  68  	  SELECT ID INTO CUR_PRD_ID FROM PRODUCT WHERE NAME = 'Archive Article' AND PRODUCT_STATUS_ID = 1 AND ROWNUM <= 1;
13:37:43  69  	EXCEPTION
13:37:43  70  	  WHEN NO_DATA_FOUND THEN
13:37:43  71  	    INSERT INTO PRODUCT (ID, NAME, PRODUCTION_COST, PRODUCT_STATUS_ID, PRODUCT_URI, UNIT_PRICE, CREATED_BY, CREATE_DATE) VALUES (PRD_ID_SEQ.NEXTVAL, 'Archive Article', '0', 1, NULL, '0', 'OFFERMAKER', SYSDATE);
13:37:43  72  	    SELECT ID INTO CUR_PRD_ID FROM PRODUCT WHERE NAME = 'Archive Article' AND PRODUCT_STATUS_ID = 1 AND ROWNUM <= 1;
13:37:43  73  	  WHEN OTHERS THEN
13:37:43  74  	    RAISE;
13:37:43  75  	END;
13:37:43  76  	SELECT ID INTO CUR_CAPABILITY_ID FROM CAPABILITY WHERE CODE IN LTRIM(RTRIM((UPPER('AAA')))) AND ROWNUM <= 1;
13:37:43  77  	INSERT INTO PRODUCT_OFFERING (ID, PRODUCT_ID, TAX_POLICY_TYPE_ID, QUANTITY, UNIT_PRICE, TAX_CATEGORY_ID, CAPABILITY_ID, CREATED_BY, CREATE_DATE) VALUES (PO_ID_SEQ.NEXTVAL, CUR_PRD_ID, '1', '200', '0', '2', CUR_CAPABILITY_ID, 'OFFERMAKER', SYSDATE);
13:37:43  78  	INSERT INTO PRODUCT_OFFERING_META_DATA (ID, PRODUCT_OFFERING_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (PROMD_ID_SEQ.NEXTVAL, PO_ID_SEQ.CURRVAL, 'entitlement_uri', 'http://:hostname:/svc/user/entitlements/archive/size/200/:id:.json', 'OFFERMAKER', SYSDATE);
13:37:43  79  	INSERT INTO PRODUCT_OFFERING_META_DATA (ID, PRODUCT_OFFERING_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (PROMD_ID_SEQ.NEXTVAL, PO_ID_SEQ.CURRVAL, 'DEFAULT_VAT_RATE', '{"*": 0.0}', 'OFFERMAKER', SYSDATE);
13:37:43  80  	INSERT INTO OFFER_PRODUCT_OFFERING (OFFER_ID, PRODUCT_OFFERING_ID, CREATED_BY, CREATE_DATE) VALUES (OFR_ID_SEQ.CURRVAL, PO_ID_SEQ.CURRVAL, 'OFFERMAKER', SYSDATE);
13:37:43  81  	BEGIN
13:37:43  82  	  SELECT ID INTO CUR_PRD_ID FROM PRODUCT WHERE NAME = 'TimesMachine' AND PRODUCT_STATUS_ID = 1 AND ROWNUM <= 1;
13:37:43  83  	EXCEPTION
13:37:43  84  	  WHEN NO_DATA_FOUND THEN
13:37:43  85  	    INSERT INTO PRODUCT (ID, NAME, PRODUCTION_COST, PRODUCT_STATUS_ID, PRODUCT_URI, UNIT_PRICE, CREATED_BY, CREATE_DATE) VALUES (PRD_ID_SEQ.NEXTVAL, 'TimesMachine', '0', 1, NULL, '0', 'OFFERMAKER', SYSDATE);
13:37:43  86  	    SELECT ID INTO CUR_PRD_ID FROM PRODUCT WHERE NAME = 'TimesMachine' AND PRODUCT_STATUS_ID = 1 AND ROWNUM <= 1;
13:37:43  87  	  WHEN OTHERS THEN
13:37:43  88  	    RAISE;
13:37:43  89  	END;
13:37:43  90  	SELECT ID INTO CUR_CAPABILITY_ID FROM CAPABILITY WHERE CODE IN LTRIM(RTRIM((UPPER('NONE')))) AND ROWNUM <= 1;
13:37:43  91  	INSERT INTO PRODUCT_OFFERING (ID, PRODUCT_ID, TAX_POLICY_TYPE_ID, QUANTITY, UNIT_PRICE, TAX_CATEGORY_ID, CAPABILITY_ID, CREATED_BY, CREATE_DATE) VALUES (PO_ID_SEQ.NEXTVAL, CUR_PRD_ID, '1', '56', '0', '2', CUR_CAPABILITY_ID, 'OFFERMAKER', SYSDATE);
13:37:43  92  	INSERT INTO PRODUCT_OFFERING_META_DATA (ID, PRODUCT_OFFERING_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (PROMD_ID_SEQ.NEXTVAL, PO_ID_SEQ.CURRVAL, 'DEFAULT_VAT_RATE', '{"*": 0.0}', 'OFFERMAKER', SYSDATE);
13:37:43  93  	INSERT INTO OFFER_PRODUCT_OFFERING (OFFER_ID, PRODUCT_OFFERING_ID, CREATED_BY, CREATE_DATE) VALUES (OFR_ID_SEQ.CURRVAL, PO_ID_SEQ.CURRVAL, 'OFFERMAKER', SYSDATE);
13:37:43  94  	BEGIN
13:37:43  95  	  SELECT ID INTO CUR_PRD_ID FROM PRODUCT WHERE NAME = 'Smartphone' AND PRODUCT_STATUS_ID = 1 AND ROWNUM <= 1;
13:37:43  96  	EXCEPTION
13:37:43  97  	  WHEN NO_DATA_FOUND THEN
13:37:43  98  	    INSERT INTO PRODUCT (ID, NAME, PRODUCTION_COST, PRODUCT_STATUS_ID, PRODUCT_URI, UNIT_PRICE, CREATED_BY, CREATE_DATE) VALUES (PRD_ID_SEQ.NEXTVAL, 'Smartphone', '0', 1, NULL, '0', 'OFFERMAKER', SYSDATE);
13:37:43  99  	    SELECT ID INTO CUR_PRD_ID FROM PRODUCT WHERE NAME = 'Smartphone' AND PRODUCT_STATUS_ID = 1 AND ROWNUM <= 1;
13:37:43 100  	  WHEN OTHERS THEN
13:37:43 101  	    RAISE;
13:37:43 102  	END;
13:37:43 103  	SELECT ID INTO CUR_CAPABILITY_ID FROM CAPABILITY WHERE CODE IN LTRIM(RTRIM((UPPER('MSD')))) AND ROWNUM <= 1;
13:37:43 104  	INSERT INTO PRODUCT_OFFERING (ID, PRODUCT_ID, TAX_POLICY_TYPE_ID, QUANTITY, UNIT_PRICE, TAX_CATEGORY_ID, CAPABILITY_ID, CREATED_BY, CREATE_DATE) VALUES (PO_ID_SEQ.NEXTVAL, CUR_PRD_ID, '1', '56', '0', '2', CUR_CAPABILITY_ID, 'OFFERMAKER', SYSDATE);
13:37:43 105  	INSERT INTO PRODUCT_OFFERING_META_DATA (ID, PRODUCT_OFFERING_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (PROMD_ID_SEQ.NEXTVAL, PO_ID_SEQ.CURRVAL, 'entitlement_uri', 'http://:hostname:/svc/user/entitlements/msd/:id:.json', 'OFFERMAKER', SYSDATE);
13:37:43 106  	INSERT INTO PRODUCT_OFFERING_META_DATA (ID, PRODUCT_OFFERING_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (PROMD_ID_SEQ.NEXTVAL, PO_ID_SEQ.CURRVAL, 'DEFAULT_VAT_RATE', '{"*": 0.0}', 'OFFERMAKER', SYSDATE);
13:37:43 107  	INSERT INTO PRODUCT_OFFERING_META_DATA (ID, PRODUCT_OFFERING_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (PROMD_ID_SEQ.NEXTVAL, PO_ID_SEQ.CURRVAL, 'capability', 'MSD', 'OFFERMAKER', SYSDATE);
13:37:43 108  	INSERT INTO OFFER_PRODUCT_OFFERING (OFFER_ID, PRODUCT_OFFERING_ID, CREATED_BY, CREATE_DATE) VALUES (OFR_ID_SEQ.CURRVAL, PO_ID_SEQ.CURRVAL, 'OFFERMAKER', SYSDATE);
13:37:43 109  	INSERT INTO OFFER_OFFER_CHAIN (OFFER_ID, OFFER_CHAIN_ID, INDEX_VALUE, NUM_RECURRENCES, CREATED_BY, CREATE_DATE, updated_by, update_date) VALUES (OFR_ID_SEQ.CURRVAL, 1188880, '0', '1', 'OFFERMAKER', SYSDATE, 'OFFERMAKER', SYSDATE);
13:37:43 110  	END;
13:37:43 111  END;
13:37:43 112  /

PL/SQL procedure successfully completed.

Elapsed: 00:00:01.08
13:37:44 SQL> 
13:37:44 SQL> DECLARE
13:37:44   2  	TMP_VAR NUMBER;
13:37:44   3  	CUR_PRD_ID NUMBER;
13:37:44   4  	CUR_CAPABILITY_ID NUMBER;
13:37:44   5  BEGIN
13:37:44   6  	BEGIN
13:37:44   7  	  SELECT 1 INTO TMP_VAR FROM OFFER_CHAIN WHERE ID = 1188881 AND ROWNUM <= 1;
13:37:44   8  	  UPDATE OFFER_CHAIN SET NAME='NYTimes: Web + Smartphone App', DESCRIPTION='Unlimited access to NYTimes.com and the NYTimes smartphone app.*', PRODUCT_URI='', VENDOR_SOURCE_ID='1', BILLING_SOURCE_ID=(SELECT ID FROM BILLING_SOURCE BS WHERE BS.NAME='DD-LivingSocial'), IS_SEAT_LICENSE=0, GROUP_ACCOUNT_TYPE_ID='NO',IS_ADDRESS_REQUIRED=1, OFFER_CHAIN_STATUS_ID = 1, UPDATE_DATE = SYSDATE, UPDATED_BY = 'OFFERMAKER', IS_GIFT_CERTIFICATE='0', REVOKE_ENTITLEMENTS = '0', ADOPTABILITY_WINDOW_START_DATE = to_date('02-Oct-2012 00:00:00','DD-MON-YY HH24:MI:SS'), ADOPTABILITY_WINDOW_END_DATE = to_date('24-Oct-2020 00:00:00','DD-MON-YY HH24:MI:SS') WHERE ID = 1188881;
13:37:44   9  	EXCEPTION
13:37:44  10  	  WHEN NO_DATA_FOUND THEN
13:37:44  11  	    INSERT INTO OFFER_CHAIN (ID, NAME, DESCRIPTION, ADOPTABILITY_WINDOW_START_DATE, ADOPTABILITY_WINDOW_END_DATE, IS_GIFT_CERTIFICATE, PRODUCT_URI, OFFER_CHAIN_STATUS_ID, REVOKE_ENTITLEMENTS, VENDOR_SOURCE_ID, BILLING_SOURCE_ID, IS_SEAT_LICENSE, GROUP_ACCOUNT_TYPE_ID, IS_ADDRESS_REQUIRED, CREATED_BY, CREATE_DATE, updated_by, update_date) VALUES (1188881, 'NYTimes: Web + Smartphone App', 'Unlimited access to NYTimes.com and the NYTimes smartphone app.*', to_date('02-Oct-2012 00:00:00','DD-MON-YY HH24:MI:SS'), to_date('24-Oct-2020 00:00:00','DD-MON-YY HH24:MI:SS'), '0', NULL, '1', '0', '1', (SELECT ID FROM BILLING_SOURCE BS WHERE BS.NAME='DD-LivingSocial'), decode('NO','IL',1,0), 'NO', '1', 'OFFERMAKER', SYSDATE, 'OFFERMAKER', SYSDATE);
13:37:44  12  	END;
13:37:44  13  	DELETE FROM OFFER_CHAIN_ELIGIBILITY WHERE offer_chain_id = 1188881;
13:37:44  14  	INSERT INTO OFFER_CHAIN_ELIGIBILITY (ID, OFFER_CHAIN_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (ELG_ID_SEQ.NEXTVAL, 1188881, 'GIFT CERTIFICATE REQUIRED', '1', 'OFFERMAKER', SYSDATE);
13:37:44  15  	INSERT INTO OFFER_CHAIN_ELIGIBILITY (ID, OFFER_CHAIN_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (ELG_ID_SEQ.NEXTVAL, 1188881, 'IS_COMP', '1', 'OFFERMAKER', SYSDATE);
13:37:44  16  	INSERT INTO OFFER_CHAIN_ELIGIBILITY (ID, OFFER_CHAIN_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (ELG_ID_SEQ.NEXTVAL, 1188881, 'MAX_CONCURRENT_SUBS', '1', 'OFFERMAKER', SYSDATE);
13:37:44  17  	DELETE FROM OFFER_CHAIN_META_DATA WHERE offer_chain_id = 1188881;
13:37:44  18  	INSERT INTO OFFER_CHAIN_META_DATA (ID, OFFER_CHAIN_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (OCMD_ID_SEQ.NEXTVAL, 1188881, 'BUNDLE_EXPLANATION', 'Bundle A - Living Social 8 Week Sub - Redeem OC', 'OFFERMAKER', SYSDATE);
13:37:44  19  	INSERT INTO OFFER_CHAIN_META_DATA (ID, OFFER_CHAIN_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (OCMD_ID_SEQ.NEXTVAL, 1188881, 'PRICE_DESCRIPTION', '8 Week Living Social Promotion Subscription for $1 - Paid to Living Social - Redemption', 'OFFERMAKER', SYSDATE);
13:37:44  20  	INSERT INTO OFFER_CHAIN_META_DATA (ID, OFFER_CHAIN_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (OCMD_ID_SEQ.NEXTVAL, 1188881, 'PRICE_SHORT_DESCRIPTION', 'BNDL A / $0 8 wks Living Social GC redemp', 'OFFERMAKER', SYSDATE);
13:37:44  21  	INSERT INTO OFFER_CHAIN_META_DATA (ID, OFFER_CHAIN_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (OCMD_ID_SEQ.NEXTVAL, 1188881, 'OFFER_TYPE', 'Living Social Subscription for 8 weeks', 'OFFERMAKER', SYSDATE);
13:37:44  22  	INSERT INTO OFFER_CHAIN_META_DATA (ID, OFFER_CHAIN_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (OCMD_ID_SEQ.NEXTVAL, 1188881, 'OFFER_PRICE', '$1 for 8 weeks', 'OFFERMAKER', SYSDATE);
13:37:44  23  	INSERT INTO OFFER_CHAIN_META_DATA (ID, OFFER_CHAIN_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (OCMD_ID_SEQ.NEXTVAL, 1188881, 'PROMO_PRICE_FOOTER_LABEL', '8 Weeks', 'OFFERMAKER', SYSDATE);
13:37:44  24  	INSERT INTO OFFER_CHAIN_META_DATA (ID, OFFER_CHAIN_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (OCMD_ID_SEQ.NEXTVAL, 1188881, 'BILLING_CYCLE', '8 week subscription', 'OFFERMAKER', SYSDATE);
13:37:44  25  	INSERT INTO OFFER_CHAIN_META_DATA (ID, OFFER_CHAIN_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (OCMD_ID_SEQ.NEXTVAL, 1188881, 'SUBSCRIBER_TYPE', 'Daily Deals', 'OFFERMAKER', SYSDATE);
13:37:44  26  	INSERT INTO OFFER_CHAIN_META_DATA (ID, OFFER_CHAIN_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (OCMD_ID_SEQ.NEXTVAL, 1188881, 'BUNDLE', 'Bundle A (Web+SP)', 'OFFERMAKER', SYSDATE);
13:37:44  27  	INSERT INTO OFFER_CHAIN_META_DATA (ID, OFFER_CHAIN_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (OCMD_ID_SEQ.NEXTVAL, 1188881, 'ADX_BUNDLE', 'MM_PROMO', 'OFFERMAKER', SYSDATE);
13:37:44  28  	INSERT INTO OFFER_CHAIN_META_DATA (ID, OFFER_CHAIN_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (OCMD_ID_SEQ.NEXTVAL, 1188881, 'SIEBEL_CAMPAIGN_CODE', '3H8W8 ', 'OFFERMAKER', SYSDATE);
13:37:44  29  	INSERT INTO OFFER_CHAIN_META_DATA (ID, OFFER_CHAIN_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (OCMD_ID_SEQ.NEXTVAL, 1188881, 'IS_COMP', '1', 'OFFERMAKER', SYSDATE);
13:37:44  30  	INSERT INTO OFFER_CHAIN_META_DATA (ID, OFFER_CHAIN_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (OCMD_ID_SEQ.NEXTVAL, 1188881, 'ANNUAL_PRICE', '195.00', 'OFFERMAKER', SYSDATE);
13:37:44  31  	INSERT INTO OFFER_CHAIN_META_DATA (ID, OFFER_CHAIN_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (OCMD_ID_SEQ.NEXTVAL, 1188881, 'UID', '16d1593beeb1083f061e3503a06e5b30f17e84904dcad88b4652c7d9ebd80077', 'OFFERMAKER', SYSDATE);
13:37:44  32  	DELETE FROM OFFER_CHAIN_NOTIFICATION_TYPE WHERE offer_chain_id = 1188881;
13:37:44  33  	BEGIN
13:37:44  34  	  SELECT 1 INTO TMP_VAR FROM ACTION WHERE NAME = 'GC_REDEEMER_ON_REDEEM';
13:37:44  35  	EXCEPTION
13:37:44  36  	  WHEN NO_DATA_FOUND THEN
13:37:44  37  	    INSERT INTO ACTION (ID, NAME, CREATE_DATE, CREATED_BY) VALUES (ACTION_ID_SEQ.NEXTVAL, 'GC_REDEEMER_ON_REDEEM', SYSDATE, 'OFFERMAKER');
13:37:44  38  	END;
13:37:44  39  	BEGIN
13:37:44  40  	  SELECT 1 INTO TMP_VAR FROM CORE_OWNER.NOTIFICATION_TYPE WHERE VALUE = 'redeemer-access-livingsocial';
13:37:44  41  	EXCEPTION
13:37:44  42  	  WHEN NO_DATA_FOUND THEN NULL;
13:37:44  43  	    -- INSERT INTO CORE_OWNER.NOTIFICATION_TYPE (ID, VALUE, TEMPLATE_URL) VALUES (CORE_OWNER.NOTTID_SEQ.NEXTVAL, 'redeemer-access-livingsocial', 'N/A');
13:37:44  44  	END;
13:37:44  45  	BEGIN
13:37:44  46  	  SELECT 1 INTO TMP_VAR FROM ACTION WHERE NAME = 'CLOSE_SUBSCRIPTION';
13:37:44  47  	EXCEPTION
13:37:44  48  	  WHEN NO_DATA_FOUND THEN
13:37:44  49  	    INSERT INTO ACTION (ID, NAME, CREATE_DATE, CREATED_BY) VALUES (ACTION_ID_SEQ.NEXTVAL, 'CLOSE_SUBSCRIPTION', SYSDATE, 'OFFERMAKER');
13:37:44  50  	END;
13:37:44  51  	BEGIN
13:37:44  52  	  SELECT 1 INTO TMP_VAR FROM CORE_OWNER.NOTIFICATION_TYPE WHERE VALUE = 'sartre-sub-expired-livingsocial';
13:37:44  53  	EXCEPTION
13:37:44  54  	  WHEN NO_DATA_FOUND THEN NULL;
13:37:44  55  	    -- INSERT INTO CORE_OWNER.NOTIFICATION_TYPE (ID, VALUE, TEMPLATE_URL) VALUES (CORE_OWNER.NOTTID_SEQ.NEXTVAL, 'sartre-sub-expired-livingsocial', 'N/A');
13:37:44  56  	END;
13:37:44  57  	INSERT INTO OFFER_CHAIN_NOTIFICATION_TYPE (ID, OFFER_CHAIN_ID, NOTIFICATION_TYPE_ID, ACTION_ID, CREATED_BY, CREATE_DATE) VALUES (OCET_ID_SEQ.NEXTVAL, 1188881, (SELECT ID FROM CORE_OWNER.NOTIFICATION_TYPE WHERE VALUE = 'redeemer-access-livingsocial'), (SELECT ID FROM ACTION WHERE NAME = 'GC_REDEEMER_ON_REDEEM'), 'OFFERMAKER', SYSDATE);
13:37:44  58  	INSERT INTO OFFER_CHAIN_NOTIFICATION_TYPE (ID, OFFER_CHAIN_ID, NOTIFICATION_TYPE_ID, ACTION_ID, CREATED_BY, CREATE_DATE) VALUES (OCET_ID_SEQ.NEXTVAL, 1188881, (SELECT ID FROM CORE_OWNER.NOTIFICATION_TYPE WHERE VALUE = 'sartre-sub-expired-livingsocial'), (SELECT ID FROM ACTION WHERE NAME = 'CLOSE_SUBSCRIPTION'), 'OFFERMAKER', SYSDATE);
13:37:44  59  	BEGIN
13:37:44  60  	  SELECT 1 INTO TMP_VAR FROM OFFER_OFFER_CHAIN WHERE OFFER_CHAIN_ID = 1188881 AND INDEX_VALUE = 0 AND ROWNUM <= 1;
13:37:44  61  	EXCEPTION
13:37:44  62  	  WHEN NO_DATA_FOUND THEN
13:37:44  63  	INSERT INTO OFFER (ID, OFFER_STATUS_ID, ENTITLEMENT_DURATION, CREATED_BY, CREATE_DATE, updated_by, update_date) VALUES (OFR_ID_SEQ.NEXTVAL, 1, 'P0Y0M56DT0H0M', 'OFFERMAKER', SYSDATE, 'OFFERMAKER', SYSDATE);
13:37:44  64  	BEGIN
13:37:44  65  	  SELECT ID INTO CUR_PRD_ID FROM PRODUCT WHERE NAME = 'Web' AND PRODUCT_STATUS_ID = 1 AND ROWNUM <= 1;
13:37:44  66  	EXCEPTION
13:37:44  67  	  WHEN NO_DATA_FOUND THEN
13:37:44  68  	    INSERT INTO PRODUCT (ID, NAME, PRODUCTION_COST, PRODUCT_STATUS_ID, PRODUCT_URI, UNIT_PRICE, CREATED_BY, CREATE_DATE) VALUES (PRD_ID_SEQ.NEXTVAL, 'Web', '0', 1, NULL, '0', 'OFFERMAKER', SYSDATE);
13:37:44  69  	    SELECT ID INTO CUR_PRD_ID FROM PRODUCT WHERE NAME = 'Web' AND PRODUCT_STATUS_ID = 1 AND ROWNUM <= 1;
13:37:44  70  	  WHEN OTHERS THEN
13:37:44  71  	    RAISE;
13:37:44  72  	END;
13:37:44  73  	SELECT ID INTO CUR_CAPABILITY_ID FROM CAPABILITY WHERE CODE IN LTRIM(RTRIM((UPPER('MM')))) AND ROWNUM <= 1;
13:37:44  74  	INSERT INTO PRODUCT_OFFERING (ID, PRODUCT_ID, TAX_POLICY_TYPE_ID, QUANTITY, UNIT_PRICE, TAX_CATEGORY_ID, CAPABILITY_ID, CREATED_BY, CREATE_DATE) VALUES (PO_ID_SEQ.NEXTVAL, CUR_PRD_ID, '1', '56', '0', '2', CUR_CAPABILITY_ID, 'OFFERMAKER', SYSDATE);
13:37:44  75  	INSERT INTO PRODUCT_OFFERING_META_DATA (ID, PRODUCT_OFFERING_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (PROMD_ID_SEQ.NEXTVAL, PO_ID_SEQ.CURRVAL, 'entitlement_uri', 'http://:hostname:/svc/user/entitlements/mm/:id:.json', 'OFFERMAKER', SYSDATE);
13:37:44  76  	INSERT INTO PRODUCT_OFFERING_META_DATA (ID, PRODUCT_OFFERING_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (PROMD_ID_SEQ.NEXTVAL, PO_ID_SEQ.CURRVAL, 'DEFAULT_VAT_RATE', '{"*": 0.0}', 'OFFERMAKER', SYSDATE);
13:37:44  77  	INSERT INTO PRODUCT_OFFERING_META_DATA (ID, PRODUCT_OFFERING_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (PROMD_ID_SEQ.NEXTVAL, PO_ID_SEQ.CURRVAL, 'capability', 'MM', 'OFFERMAKER', SYSDATE);
13:37:44  78  	INSERT INTO OFFER_PRODUCT_OFFERING (OFFER_ID, PRODUCT_OFFERING_ID, CREATED_BY, CREATE_DATE) VALUES (OFR_ID_SEQ.CURRVAL, PO_ID_SEQ.CURRVAL, 'OFFERMAKER', SYSDATE);
13:37:44  79  	BEGIN
13:37:44  80  	  SELECT ID INTO CUR_PRD_ID FROM PRODUCT WHERE NAME = 'Mobile' AND PRODUCT_STATUS_ID = 1 AND ROWNUM <= 1;
13:37:44  81  	EXCEPTION
13:37:44  82  	  WHEN NO_DATA_FOUND THEN
13:37:44  83  	    INSERT INTO PRODUCT (ID, NAME, PRODUCTION_COST, PRODUCT_STATUS_ID, PRODUCT_URI, UNIT_PRICE, CREATED_BY, CREATE_DATE) VALUES (PRD_ID_SEQ.NEXTVAL, 'Mobile', '0', 1, NULL, '0', 'OFFERMAKER', SYSDATE);
13:37:44  84  	    SELECT ID INTO CUR_PRD_ID FROM PRODUCT WHERE NAME = 'Mobile' AND PRODUCT_STATUS_ID = 1 AND ROWNUM <= 1;
13:37:44  85  	  WHEN OTHERS THEN
13:37:44  86  	    RAISE;
13:37:44  87  	END;
13:37:44  88  	SELECT ID INTO CUR_CAPABILITY_ID FROM CAPABILITY WHERE CODE IN LTRIM(RTRIM((UPPER('MOW')))) AND ROWNUM <= 1;
13:37:44  89  	INSERT INTO PRODUCT_OFFERING (ID, PRODUCT_ID, TAX_POLICY_TYPE_ID, QUANTITY, UNIT_PRICE, TAX_CATEGORY_ID, CAPABILITY_ID, CREATED_BY, CREATE_DATE) VALUES (PO_ID_SEQ.NEXTVAL, CUR_PRD_ID, '1', '56', '0', '2', CUR_CAPABILITY_ID, 'OFFERMAKER', SYSDATE);
13:37:44  90  	INSERT INTO PRODUCT_OFFERING_META_DATA (ID, PRODUCT_OFFERING_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (PROMD_ID_SEQ.NEXTVAL, PO_ID_SEQ.CURRVAL, 'entitlement_uri', 'http://:hostname:/svc/user/entitlements/mow/:id:.json', 'OFFERMAKER', SYSDATE);
13:37:44  91  	INSERT INTO PRODUCT_OFFERING_META_DATA (ID, PRODUCT_OFFERING_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (PROMD_ID_SEQ.NEXTVAL, PO_ID_SEQ.CURRVAL, 'DEFAULT_VAT_RATE', '{"*": 0.0}', 'OFFERMAKER', SYSDATE);
13:37:44  92  	INSERT INTO PRODUCT_OFFERING_META_DATA (ID, PRODUCT_OFFERING_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (PROMD_ID_SEQ.NEXTVAL, PO_ID_SEQ.CURRVAL, 'capability', 'MOW', 'OFFERMAKER', SYSDATE);
13:37:44  93  	INSERT INTO OFFER_PRODUCT_OFFERING (OFFER_ID, PRODUCT_OFFERING_ID, CREATED_BY, CREATE_DATE) VALUES (OFR_ID_SEQ.CURRVAL, PO_ID_SEQ.CURRVAL, 'OFFERMAKER', SYSDATE);
13:37:44  94  	BEGIN
13:37:44  95  	  SELECT ID INTO CUR_PRD_ID FROM PRODUCT WHERE NAME = 'Archive Article' AND PRODUCT_STATUS_ID = 1 AND ROWNUM <= 1;
13:37:44  96  	EXCEPTION
13:37:44  97  	  WHEN NO_DATA_FOUND THEN
13:37:44  98  	    INSERT INTO PRODUCT (ID, NAME, PRODUCTION_COST, PRODUCT_STATUS_ID, PRODUCT_URI, UNIT_PRICE, CREATED_BY, CREATE_DATE) VALUES (PRD_ID_SEQ.NEXTVAL, 'Archive Article', '0', 1, NULL, '0', 'OFFERMAKER', SYSDATE);
13:37:44  99  	    SELECT ID INTO CUR_PRD_ID FROM PRODUCT WHERE NAME = 'Archive Article' AND PRODUCT_STATUS_ID = 1 AND ROWNUM <= 1;
13:37:44 100  	  WHEN OTHERS THEN
13:37:44 101  	    RAISE;
13:37:44 102  	END;
13:37:44 103  	SELECT ID INTO CUR_CAPABILITY_ID FROM CAPABILITY WHERE CODE IN LTRIM(RTRIM((UPPER('AAA')))) AND ROWNUM <= 1;
13:37:44 104  	INSERT INTO PRODUCT_OFFERING (ID, PRODUCT_ID, TAX_POLICY_TYPE_ID, QUANTITY, UNIT_PRICE, TAX_CATEGORY_ID, CAPABILITY_ID, CREATED_BY, CREATE_DATE) VALUES (PO_ID_SEQ.NEXTVAL, CUR_PRD_ID, '1', '200', '0', '2', CUR_CAPABILITY_ID, 'OFFERMAKER', SYSDATE);
13:37:44 105  	INSERT INTO PRODUCT_OFFERING_META_DATA (ID, PRODUCT_OFFERING_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (PROMD_ID_SEQ.NEXTVAL, PO_ID_SEQ.CURRVAL, 'entitlement_uri', 'http://:hostname:/svc/user/entitlements/archive/size/200/:id:.json', 'OFFERMAKER', SYSDATE);
13:37:44 106  	INSERT INTO PRODUCT_OFFERING_META_DATA (ID, PRODUCT_OFFERING_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (PROMD_ID_SEQ.NEXTVAL, PO_ID_SEQ.CURRVAL, 'DEFAULT_VAT_RATE', '{"*": 0.0}', 'OFFERMAKER', SYSDATE);
13:37:44 107  	INSERT INTO OFFER_PRODUCT_OFFERING (OFFER_ID, PRODUCT_OFFERING_ID, CREATED_BY, CREATE_DATE) VALUES (OFR_ID_SEQ.CURRVAL, PO_ID_SEQ.CURRVAL, 'OFFERMAKER', SYSDATE);
13:37:44 108  	BEGIN
13:37:44 109  	  SELECT ID INTO CUR_PRD_ID FROM PRODUCT WHERE NAME = 'TimesMachine' AND PRODUCT_STATUS_ID = 1 AND ROWNUM <= 1;
13:37:44 110  	EXCEPTION
13:37:44 111  	  WHEN NO_DATA_FOUND THEN
13:37:44 112  	    INSERT INTO PRODUCT (ID, NAME, PRODUCTION_COST, PRODUCT_STATUS_ID, PRODUCT_URI, UNIT_PRICE, CREATED_BY, CREATE_DATE) VALUES (PRD_ID_SEQ.NEXTVAL, 'TimesMachine', '0', 1, NULL, '0', 'OFFERMAKER', SYSDATE);
13:37:44 113  	    SELECT ID INTO CUR_PRD_ID FROM PRODUCT WHERE NAME = 'TimesMachine' AND PRODUCT_STATUS_ID = 1 AND ROWNUM <= 1;
13:37:44 114  	  WHEN OTHERS THEN
13:37:44 115  	    RAISE;
13:37:44 116  	END;
13:37:44 117  	SELECT ID INTO CUR_CAPABILITY_ID FROM CAPABILITY WHERE CODE IN LTRIM(RTRIM((UPPER('NONE')))) AND ROWNUM <= 1;
13:37:44 118  	INSERT INTO PRODUCT_OFFERING (ID, PRODUCT_ID, TAX_POLICY_TYPE_ID, QUANTITY, UNIT_PRICE, TAX_CATEGORY_ID, CAPABILITY_ID, CREATED_BY, CREATE_DATE) VALUES (PO_ID_SEQ.NEXTVAL, CUR_PRD_ID, '1', '56', '0', '2', CUR_CAPABILITY_ID, 'OFFERMAKER', SYSDATE);
13:37:44 119  	INSERT INTO PRODUCT_OFFERING_META_DATA (ID, PRODUCT_OFFERING_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (PROMD_ID_SEQ.NEXTVAL, PO_ID_SEQ.CURRVAL, 'DEFAULT_VAT_RATE', '{"*": 0.0}', 'OFFERMAKER', SYSDATE);
13:37:44 120  	INSERT INTO OFFER_PRODUCT_OFFERING (OFFER_ID, PRODUCT_OFFERING_ID, CREATED_BY, CREATE_DATE) VALUES (OFR_ID_SEQ.CURRVAL, PO_ID_SEQ.CURRVAL, 'OFFERMAKER', SYSDATE);
13:37:44 121  	BEGIN
13:37:44 122  	  SELECT ID INTO CUR_PRD_ID FROM PRODUCT WHERE NAME = 'Smartphone' AND PRODUCT_STATUS_ID = 1 AND ROWNUM <= 1;
13:37:44 123  	EXCEPTION
13:37:44 124  	  WHEN NO_DATA_FOUND THEN
13:37:44 125  	    INSERT INTO PRODUCT (ID, NAME, PRODUCTION_COST, PRODUCT_STATUS_ID, PRODUCT_URI, UNIT_PRICE, CREATED_BY, CREATE_DATE) VALUES (PRD_ID_SEQ.NEXTVAL, 'Smartphone', '0', 1, NULL, '0', 'OFFERMAKER', SYSDATE);
13:37:44 126  	    SELECT ID INTO CUR_PRD_ID FROM PRODUCT WHERE NAME = 'Smartphone' AND PRODUCT_STATUS_ID = 1 AND ROWNUM <= 1;
13:37:44 127  	  WHEN OTHERS THEN
13:37:44 128  	    RAISE;
13:37:44 129  	END;
13:37:44 130  	SELECT ID INTO CUR_CAPABILITY_ID FROM CAPABILITY WHERE CODE IN LTRIM(RTRIM((UPPER('MSD')))) AND ROWNUM <= 1;
13:37:44 131  	INSERT INTO PRODUCT_OFFERING (ID, PRODUCT_ID, TAX_POLICY_TYPE_ID, QUANTITY, UNIT_PRICE, TAX_CATEGORY_ID, CAPABILITY_ID, CREATED_BY, CREATE_DATE) VALUES (PO_ID_SEQ.NEXTVAL, CUR_PRD_ID, '1', '56', '0', '2', CUR_CAPABILITY_ID, 'OFFERMAKER', SYSDATE);
13:37:44 132  	INSERT INTO PRODUCT_OFFERING_META_DATA (ID, PRODUCT_OFFERING_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (PROMD_ID_SEQ.NEXTVAL, PO_ID_SEQ.CURRVAL, 'entitlement_uri', 'http://:hostname:/svc/user/entitlements/msd/:id:.json', 'OFFERMAKER', SYSDATE);
13:37:44 133  	INSERT INTO PRODUCT_OFFERING_META_DATA (ID, PRODUCT_OFFERING_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (PROMD_ID_SEQ.NEXTVAL, PO_ID_SEQ.CURRVAL, 'DEFAULT_VAT_RATE', '{"*": 0.0}', 'OFFERMAKER', SYSDATE);
13:37:44 134  	INSERT INTO PRODUCT_OFFERING_META_DATA (ID, PRODUCT_OFFERING_ID, NAME, VALUE, CREATED_BY, CREATE_DATE) VALUES (PROMD_ID_SEQ.NEXTVAL, PO_ID_SEQ.CURRVAL, 'capability', 'MSD', 'OFFERMAKER', SYSDATE);
13:37:44 135  	INSERT INTO OFFER_PRODUCT_OFFERING (OFFER_ID, PRODUCT_OFFERING_ID, CREATED_BY, CREATE_DATE) VALUES (OFR_ID_SEQ.CURRVAL, PO_ID_SEQ.CURRVAL, 'OFFERMAKER', SYSDATE);
13:37:44 136  	INSERT INTO OFFER_OFFER_CHAIN (OFFER_ID, OFFER_CHAIN_ID, INDEX_VALUE, NUM_RECURRENCES, CREATED_BY, CREATE_DATE, updated_by, update_date) VALUES (OFR_ID_SEQ.CURRVAL, 1188881, '0', '1', 'OFFERMAKER', SYSDATE, 'OFFERMAKER', SYSDATE);
13:37:44 137  	END;
13:37:44 138  END;
13:37:44 139  /
DECLARE
*
ERROR at line 1:
ORA-02291: integrity constraint (CORE_OWNER.OPS_NT_OCHNT_FK) violated - parent 
key not found 
ORA-06512: at line 57 




Subject: Nomad upgrade completed with errors: ECPR@rac01.prd.ewr1.nytimes.com
From: Nomad for Oracle <nytd_oracledba@nytimes.com>
To: nytd_ecommerce@nytimes.com
Cc: nytd_oracledba@nytimes.com

Nomad upgrade operation has errors. 
        
        Details
        -------
        DB Hostname: rac01.prd.ewr1.nytimes.com
        DB Role: PRIMARY
        SID: ECPR
        Schema: core_owner
        Migration: 22.2-create-offers-SAR-247
        SVN Revision: 10648
        Duration: 1 sec.
        DBA: sbao
        Service Request: https://jira.em.nytimes.com/browse/ORA-384        
        
        Error Detail
        ------------
        
        ERROR at line 1: ORA-02291: integrity constraint (CORE_OWNER.OPS_NT_OCHNT_FK) violated - parent key not found ORA-06512: at line 57